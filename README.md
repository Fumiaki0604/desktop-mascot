# Desktop Mascot Enhanced

Windows用の高機能デスクトップマスコットアプリケーションです。透明ウィンドウに画像を表示し、RSSフィード記事の読み上げ、リップシンクアニメーション、天気表示などの機能を提供します。

## ✨ 主な機能

### 🎭 アニメーション
- **瞬きアニメーション**: 自動で目を閉じる動作（ランダム間隔）
- **ホップアニメーション**: 15秒ごとのアイドルアニメーション
- **リップシンク**: 音声再生中に口が動くリアルタイムアニメーション
- **透明背景**: クリック透過・最前面表示対応

### 📰 RSS機能
- **マルチフィード対応**: 複数のRSSフィードを設定可能
- **記事制限**: 最大30件の記事を管理（重複除外機能付き）
- **手動操作**: クリックで記事表示、前後の記事に移動可能
- **サムネイル表示**: 記事のサムネイル画像を自動抽出

### 🔊 音声合成（VOICEVOX）
- **記事読み上げ**: VOICEVOX APIを使用した記事の音声読み上げ
- **話者選択**: 複数の声質から選択可能
- **リアルタイム連携**: 音声再生と同期したリップシンク

### 🌤️ 天気表示
- **東京エリアの天気**: Open-Meteo APIを使用した天気情報表示
- **自動更新**: 1時間ごとに更新
- **気温表示**: 現在の気温を表示

### ⚙️ 操作方法
- **左クリック**: 記事を表示
- **右クリック**: 設定メニュー
- **読み上げボタン**: 記事を音声で読み上げ
- **前/次ボタン**: 記事の前後移動
- **ドラッグ**: マスコット移動

## 🛠️ 必要なソフトウェア

- **Windows 10/11**
- **.NET 8.0 Runtime** (https://dotnet.microsoft.com/download/dotnet/8.0)

## 🚀 セットアップ

### 1. 依存関係のインストール

.NET 8.0 SDKまたはRuntimeをインストールしてください。

### 2. ビルド

```bash
# デバッグビルド
dotnet build

# リリースビルド
dotnet build -c Release

# 自己完結型の実行ファイル生成
dotnet publish -c Release -r win-x64 --self-contained
```

### 3. 実行

```bash
# デバッグ版
bin\Debug\net8.0-windows\DesktopMascotEnhanced.exe

# リリース版
bin\Release\net8.0-windows\DesktopMascotEnhanced.exe
```

または、ワンクリック起動用のバッチファイルを使用：
```bash
start_mascot.bat
```

## 📁 画像アセットの配置

マスコットの動作には画像ファイルが必要です：

### 必須画像
- **基本画像**: マスコットの通常状態の画像

### オプション画像（ファイル名に応じて自動読み込み）
- **瞬き用**: `[基本画像名]_blink.png` - 目を閉じた状態
- **リップシンク用**: `[基本画像名]_mouth1.png`, `_mouth2.png`, `_mouth3.png` など - 口の形が異なる画像

**画像サイズ**: 横幅150pxに自動調整されます（アスペクト比維持）

### 例
基本画像が `mascot.png` の場合：
```
mascot.png          # 基本画像
mascot_blink.png    # 瞬き用
mascot_mouth1.png   # リップシンク用1
mascot_mouth2.png   # リップシンク用2
mascot_mouth3.png   # リップシンク用3
```

## ⚙️ 設定

設定は自動的に `%AppData%\DesktopMascot\settings.json` に保存されます。

### 設定項目

#### 基本設定
- マスコット画像の選択
- 透明度の調整
- 最前面表示の切り替え
- ウィンドウ位置の保存

#### 音声合成設定
- VOICEVOX API有効化/無効化
- APIキーの設定
- 話者（声質）の選択

#### RSSフィード設定
- フィードの追加/編集/削除
- 個別フィードの有効化/無効化
- 複数フィードの管理

## 📦 依存パッケージ

- **NAudio 2.2.1**: 音声解析とリップシンク制御
- **System.Net.Http 4.3.4**: RSSフィード取得とAPI通信
- **System.Text.Json 8.0.5**: 設定ファイルとAPIレスポンスの解析

## 🔧 開発情報

### アーキテクチャ

すべての機能が単一ファイル `DesktopMascotEnhanced.cs` に実装されています：

- **Win32Api**: ウィンドウ透過・クリックスルー制御
- **RssService**: RSS記事の取得と管理
- **VoiceVoxService**: 音声合成とリップシンク制御
- **WeatherService**: 天気情報の取得
- **MascotWindow**: メインウィンドウとアニメーション制御
- **SpeechBubbleWindow**: 記事表示用吹き出しウィンドウ
- **SettingsWindow**: 設定画面（タブ形式）

### ウィンドウサイズ
- **マスコットウィンドウ**: 150x300px（マスコット150x270px + 天気30px）
- **設定ウィンドウ**: 500x500px（タブ形式）
- **吹き出しウィンドウ**: 420x280px

## 🐛 トラブルシューティング

### 音声読み上げが動作しない
1. 設定で「音声合成を有効化」がONになっているか確認
2. VOICEVOX APIキーが正しく設定されているか確認
3. コンソールログで詳細なエラー情報を確認

### 画像が表示されない
1. 画像ファイルのパスが正しいか確認
2. 画像形式がPNGまたはJPEGであることを確認
3. 設定から画像を再選択

### RSSフィードが取得できない
1. インターネット接続を確認
2. フィードURLが有効であることを確認
3. コンソールログでエラー詳細を確認

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🙏 謝辞

- **VOICEVOX**: 音声合成API提供
- **Open-Meteo**: 天気情報API提供
- **NAudio**: オーディオ解析ライブラリ

---

**Note**: このアプリケーションは.NET 8.0 WPFで構築されており、Windows専用です。
